"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([[799],{91799:(e,t,n)=>{n.r(t),n.d(t,{default:()=>E});var a=n(32735),r=n(60216),s=n.n(r),i=n(62771),l=n(28619),o=n(21572),c=n(57270),u=n(43418),m=n(77331);function d(){return d=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},d.apply(this,arguments)}const{formatDate:p}=i.utils;function f(e){const{displaySets:t,viewportIndex:n,viewportLabel:r,servicesManager:s,extensionManager:f,viewportOptions:E}=e,{t:g}=(0,o.$G)("Common"),{measurementService:v,cornerstoneViewportService:b}=s.services,S=t[0],[w]=(0,u.I)(),[h,x]=(0,a.useState)(!1),[y,I]=(0,a.useState)(null),[N,D]=(0,a.useState)(null),{trackedSeries:k}=w.context,V=E.viewportId,{SeriesDate:O,SeriesDescription:M,SeriesInstanceUID:P,SeriesNumber:T}=S,{PatientID:C,PatientName:R,PatientSex:U,PatientAge:_,SliceThickness:j,SpacingBetweenSlices:A,StudyDate:F,ManufacturerModelName:L}=S.images[0],W=(0,a.useCallback)((()=>{const e=b.getCornerstoneViewportByIndex(n);if(e instanceof m.BaseVolumeViewport){const t=e?.getCurrentImageId();if(!t)return void(h&&x(!1))}k.includes(P)!==h&&x(!h)}),[h,w,n,P]),q=(0,a.useCallback)((e=>{e.detail.element!==N&&(e.detail.element?.addEventListener(m.Enums.Events.VOLUME_VIEWPORT_NEW_VOLUME,W),D(e.detail.element))}),[W,N]),B=(0,a.useCallback)((()=>{N?.removeEventListener(m.Enums.Events.VOLUME_VIEWPORT_NEW_VOLUME,W)}),[W,N]);(0,a.useEffect)(W,[W]),(0,a.useEffect)((()=>{const{unsubscribe:e}=b.subscribe(b.EVENTS.VIEWPORT_DATA_CHANGED,(e=>{e.viewportIndex===n&&W()}));return()=>{e()}}),[W,n]),(0,a.useEffect)((()=>h?(c.annotation.config.style.setViewportToolStyles(V,{global:{lineDash:""}}),void b.getRenderingEngine().renderViewport(V)):(c.annotation.config.style.setViewportToolStyles(V,{global:{lineDash:"4,4"}}),b.getRenderingEngine().renderViewport(V),()=>{c.annotation.config.style.setViewportToolStyles(V,{})})),[h]);return a.createElement(a.Fragment,null,a.createElement(l.uY,{onDoubleClick:e=>{e.stopPropagation(),e.preventDefault()},useAltStyling:h,onArrowsClick:e=>function(e){const t=function(e,t,n,a){const{measurementService:r,viewportGridService:s}=t.services,i=r.getMeasurements(),{activeViewportIndex:l,viewports:o}=s.getState(),{displaySetInstanceUIDs:c}=o[l],{trackedSeries:u}=a.context,m=i.filter((e=>u.includes(e.referenceSeriesUID)&&c.includes(e.displaySetInstanceUID)));if(!m.length)return;const d=m.length,p=m.map((e=>e.uid));let f=p.findIndex((e=>e===n));return-1===f?f=0:"left"===e?(f--,f<0&&(f=d-1)):"right"===e&&(f++,f===d&&(f=0)),p[f]}(e,s,y,w);t&&(I(t),v.jumpToMeasurement(n,t))}(e),getStatusComponent:()=>function(e){const t=e?"status-tracked":"status-untracked";return a.createElement("div",{className:"relative"},a.createElement(l.u,{position:"bottom-left",content:a.createElement("div",{className:"flex py-2"},a.createElement("div",{className:"flex pt-1"},a.createElement(l.JO,{name:"info-link",className:"w-4 text-primary-main"})),a.createElement("div",{className:"flex ml-4"},a.createElement("span",{className:"text-base text-common-light"},e?a.createElement(a.Fragment,null,"Series is",a.createElement("span",{className:"font-bold text-white"}," tracked")," and can be viewed ",a.createElement("br",null)," in the measurement panel"):a.createElement(a.Fragment,null,"Measurements for",a.createElement("span",{className:"font-bold text-white"}," untracked "),"series ",a.createElement("br",null)," will not be shown in the ",a.createElement("br",null)," measurements panel"))))},a.createElement(l.JO,{name:t,className:"text-primary-light"})))}(h),studyData:{label:r,studyDate:p(O)||p(F)||g("NoStudyDate"),currentSeries:T,seriesDescription:M,patientInformation:{patientName:R?i.default.utils.formatPN(R):"",patientSex:U||"",patientAge:_||"",MRN:C||"",thickness:j?`${parseFloat(j).toFixed(2)}mm`:"",spacing:void 0!==A?`${parseFloat(A).toFixed(2)}mm`:"",scanner:L||""}}}),a.createElement("div",{className:"relative flex flex-row w-full h-full overflow-hidden"},(()=>{const{component:t}=f.getModuleEntry("@ohif/extension-cornerstone.viewportModule.cornerstone");return a.createElement(t,d({},e,{onElementEnabled:q,onElementDisabled:B}))})()))}f.propTypes={displaySets:s().arrayOf(s().object.isRequired).isRequired,viewportIndex:s().number.isRequired,dataSource:s().object,children:s().node,customProps:s().object},f.defaultProps={customProps:{}};const E=f}}]);
//# sourceMappingURL=799.bundle.626f6f2f024673fef795.js.map